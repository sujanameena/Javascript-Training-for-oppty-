<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Callbacks + API â€“ Oppty Tech Hub Location</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: #fff;
      padding: 20px 24px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      max-width: 600px;
      width: 100%;
    }
    h1 {
      font-size: 20px;
      text-align: center;
      margin: 0 0 10px;
    }
    .status {
      font-size: 14px;
      margin-bottom: 8px;
      min-height: 18px;
      color: #555;
    }
    .status.error {
      color: #d9534f;
    }
    button {
      width: 100%;
      padding: 8px 0;
      border: none;
      border-radius: 4px;
      background: #007bff;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      margin-bottom: 10px;
    }
    button:disabled {
      background: #7aaef5;
      cursor: not-allowed;
    }
    .info {
      font-size: 14px;
      margin-bottom: 8px;
    }
    .map-wrapper {
      position: relative;
      width: 100%;
      height: 350px;
      border-radius: 4px;
      overflow: hidden;
    }
    .map-frame {
      width: 100%;
      height: 100%;
      border: 0;
    }
    .map-overlay-link {
      position: absolute;
      inset: 0;
      text-indent: -9999px;
      cursor: pointer;
      background: transparent;
    }
    .hint {
      font-size: 12px;
      color: #666;
      margin-top: 4px;
      text-align: right;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Oppty Tech Hub Location (Callback Demo)</h1>

    <div id="status" class="status"></div>

    <button id="loadLocationBtn">Load Google Maps Location</button>

    <div id="locationInfo" class="info"></div>

    <!-- Google Maps "image" (iframe) that is fully clickable -->
    <div class="map-wrapper" id="mapWrapper" style="display:none;">
      <iframe
        id="mapFrame"
        class="map-frame"
        src=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade">
      </iframe>
      <!-- Clicking anywhere on the map opens Google Maps in a new tab -->
      <a id="mapClickOverlay"
         class="map-overlay-link"
         href="#"
         target="_blank">
        Open in Google Maps
      </a>
    </div>
    <div class="hint" id="hint" style="display:none;">
      Click on the map to open Google Maps.
    </div>
  </div>

  <script>
    // Callback-based "API" returning Oppty Tech Hub location
    function fetchOpptyLocation(callback) {
      setTimeout(function () {
        try {
          const data = {
            name: "Oppty TechHub Private Limited",
            address:
              "Oppty TechHub Private Limited, 2nd Floor, Sai Prakash Arcade, " +
              "Nizampet X Roads, Kukatpally, Hyderabad, Telangana 500072, India",
            lat: 17.4981219,
            lng: 78.3352966,
            // Embed URL for showing the map (used as the 'image')
            embedUrl:
              "https://www.google.com/maps?q=17.4981219,78.3352966&z=18&output=embed",
            // Full Google Maps URL (used when user clicks the image)
            mapsUrl:
              "https://www.google.com/maps/place/Oppty+TechHub+Private+Limited/" +
              "@17.498127,78.3327217,636m/data=!3m2!1e3!4b1!4m6!3m5!" +
              "1s0x3bcb93d5ccaa5227:0xde534d4e3362e42b!8m2!3d17.4981219!" +
              "4d78.3352966!16s%2Fg%2F11xvm_rfgl?entry=ttu"
          };
          callback(null, data);
        } catch (err) {
          callback(err, null);
        }
      }, 800); // simulate network delay
    }

    const statusEl = document.getElementById("status");
    const loadLocationBtn = document.getElementById("loadLocationBtn");
    const locationInfoEl = document.getElementById("locationInfo");
    const mapFrame = document.getElementById("mapFrame");
    const mapWrapper = document.getElementById("mapWrapper");
    const mapClickOverlay = document.getElementById("mapClickOverlay");
    const hintEl = document.getElementById("hint");

    function setStatus(msg, isError) {
      statusEl.textContent = msg || "";
      statusEl.classList.toggle("error", !!isError);
    }

    loadLocationBtn.addEventListener("click", function () {
      setStatus("Fetching Oppty Tech Hub location (via callback)...", false);
      loadLocationBtn.disabled = true;
      locationInfoEl.textContent = "";
      mapWrapper.style.display = "none";
      hintEl.style.display = "none";
      mapFrame.src = "";
      mapClickOverlay.href = "#";

      // Use the callback-based API
      fetchOpptyLocation(function (err, location) {
        loadLocationBtn.disabled = false;

        if (err) {
          setStatus("Failed to fetch location: " + err.message, true);
          return;
        }

        setStatus("Location loaded successfully from API (callback).", false);

        locationInfoEl.innerHTML =
          "<strong>" + location.name + "</strong><br>" +
          location.address + "<br>" +
          "Lat: " + location.lat + ", Lng: " + location.lng;

        // Set iframe src to embed URL (acts as the Google Maps image)
        mapFrame.src = location.embedUrl;

        // Set overlay link to full Google Maps URL
        mapClickOverlay.href = location.mapsUrl;

        mapWrapper.style.display = "block";
        hintEl.style.display = "block"; 
      });
    });
  </script>
</body>
</html>